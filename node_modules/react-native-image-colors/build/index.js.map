{"version":3,"file":"index.js","sourceRoot":"","sources":["../src/index.ts"],"names":[],"mappings":"AAAA,gFAAgF;AAChF,8CAA8C;AAC9C,OAAO,EAAsB,KAAK,EAAE,MAAM,cAAc,CAAA;AAExD,OAAO,EAAE,KAAK,EAAE,MAAM,SAAS,CAAA;AAC/B,OAAO,mBAAmB,MAAM,UAAU,CAAA;AAG1C,MAAM,WAAW,GAAG,GAAG,CAAA;AAEvB,MAAM,kBAAkB,GAAG,CAAC,MAAmC,EAAU,EAAE;IACzE,IAAI,OAAO,MAAM,KAAK,QAAQ,EAAE;QAC9B,OAAO,MAAM,CAAA;KACd;SAAM;QACL,OAAO,KAAK,CAAC,kBAAkB,CAAC,MAAM,CAAC,CAAC,GAAG,CAAA;KAC5C;AACH,CAAC,CAAA;AAED;;;;;;;;;;;GAWG;AACH,MAAM,SAAS,GAAG,KAAK,EAAE,GAAW,EAAE,SAA0B,EAAE,EAAE,EAAE;IACpE,MAAM,WAAW,GAAG,kBAAkB,CAAC,GAAG,CAAC,CAAA;IAE3C,IAAI,MAAM,EAAE,KAAK,EAAE;QACjB,MAAM,YAAY,GAAG,MAAM,CAAC,GAAG;YAC7B,CAAC,CAAC,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,GAAG,CAAC;YAC3B,CAAC,CAAC,KAAK,CAAC,OAAO,CAAC,WAAW,CAAC,CAAA;QAE9B,IAAI,YAAY;YAAE,OAAO,YAAY,CAAA;KACtC;IAED,MAAM,MAAM,GAAsB,MAAM,mBAAmB,CAAC,SAAS,CACnE,WAAW,EACX,MAAM,CACP,CAAA;IAED,IAAI,MAAM,EAAE,KAAK,EAAE;QACjB,IAAI,CAAC,MAAM,CAAC,GAAG,IAAI,WAAW,CAAC,MAAM,GAAG,WAAW,EAAE;YACnD,MAAM,IAAI,KAAK,CACb,iIAAiI,WAAW,mCAAmC,CAChL,CAAA;SACF;QAED,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,GAAG,IAAI,WAAW,EAAE,MAAM,CAAC,CAAA;KACjD;IAED,OAAO,MAAM,CAAA;AACf,CAAC,CAAA;AAED,MAAM,WAAW,GAAG;IAClB,SAAS;IACT,KAAK;CACN,CAAA;AAED,eAAe,WAAW,CAAA;AAE1B,OAAO,EAAE,SAAS,EAAE,KAAK,EAAE,CAAA","sourcesContent":["// Import the native module. On web, it will be resolved to RNImageColors.web.ts\n// and on native platforms to RNImageColors.ts\nimport { ImageRequireSource, Image } from 'react-native'\n\nimport { cache } from './cache'\nimport RNImageColorsModule from './module'\nimport { ImageColorsResult, Config } from './types'\n\nconst MAX_KEY_LEN = 500\n\nconst resolveImageSource = (source: string | ImageRequireSource): string => {\n  if (typeof source === 'string') {\n    return source\n  } else {\n    return Image.resolveAssetSource(source).uri\n  }\n}\n\n/**\n *\n * @param uri - source of the image. Can be a remote URL, a base64 string or a local file path.\n * ```ts\n *  const fromUrl = await getColors('https://example.com/image.jpg')\n *\n *  const fromBase64 = await getColors('data:image/jpeg;base64,/9j/4Ri...')\n *\n *  const fromLocalFile = await getColors(require('./images/cat.jpg'))\n * ```\n * @param config - configuration\n */\nconst getColors = async (uri: string, config: Partial<Config> = {}) => {\n  const resolvedSrc = resolveImageSource(uri)\n\n  if (config?.cache) {\n    const cachedResult = config.key\n      ? cache.getItem(config.key)\n      : cache.getItem(resolvedSrc)\n\n    if (cachedResult) return cachedResult\n  }\n\n  const result: ImageColorsResult = await RNImageColorsModule.getColors(\n    resolvedSrc,\n    config\n  )\n\n  if (config?.cache) {\n    if (!config.key && resolvedSrc.length > MAX_KEY_LEN) {\n      throw new Error(\n        `You enabled caching, but you didn't pass a key. We fallback to using the image URI as the key. However the URI is longer than ${MAX_KEY_LEN}. Please pass a short unique key.`\n      )\n    }\n\n    cache.setItem(config.key ?? resolvedSrc, result)\n  }\n\n  return result\n}\n\nconst ImageColors = {\n  getColors,\n  cache,\n}\n\nexport default ImageColors\n\nexport { getColors, cache }\nexport type { ImageColorsResult }\n"]}